<h4>STM8 - работа с STM8-GDB.</h4>
<p>Так-с. openocd уже должен быть запущен. Запускаем gdb. Но прежде советую изменить рабочую деректорию на ту, которая содержит elf-файл. Затем команда:</p>
<pre>
  stm8-gdb <имя elf-файла>
</pre>
<p>Это откроет сессию gdb, о чем нам скажет приглашение в командной строке ввиде <i>(gdb)</i>. Кстати, весь ввод в gdb буду выделять наличием этого приглашения. Затем необходимо подключиться к локальному порту, который открыл openocd. Подключаемся командой:</p>
<pre>
  (gdb) target remote :3333
</pre>
<p>Ну, и по сути начинать отлаживать код, периодически подглядывая в справку gdb.</p>
<p>Некоторые подсказки:</p>
<pre>
--------------------------------------------------------------------------------
  Точки останова
--------------------------------------------------------------------------------
  (gdb) b <адрес в памяти или номер строки в исходном файле>
  // Устанавливает точку останова на адрес памяти или номер строки в листинге.

  (gdb) i b
  // Выводит информацию о точках останова

  (gdb) d b <номер точки останова>
  // Удаляет точку останова. Если номер точки не указан, то будут удалены все
  // точки, но необходимо указать команду в виде "d break".
--------------------------------------------------------------------------------
  Листинг программы
--------------------------------------------------------------------------------
  (gdb) l
  // Выводит исходник программы с самого начала. Пачками, соответсвующими
  // настройкам. Если ввести команду еще раз, то выдаст следующий кусок.

  (gdb) l <номер строки>
  // Выдаст кусок кода с указанной строкой в середине.
--------------------------------------------------------------------------------
  Работа с памятью(и регистрами - они ведь в общем котле)
--------------------------------------------------------------------------------
  (gdb) x/1tb <адрес>
  // x - вывести значение
  // 1 - какое кол-во блоков выводить (размер блока определяет третий параметр)
  // t - в двоичном формате есть другие форматы. См. мануал по gdb, гл. 10.6
  // b - размер выводимого блока (b - байт).
  // Формат можно указать один раз. Далее он сохранится
--------------------------------------------------------------------------------
  Запуск программы
--------------------------------------------------------------------------------
  (gdb) c
  // Продолжает выполнение программы, пока не встретися точка останова, условие
  // останова или выполнение не прервут вручную сочетанием клавиш &lt;Ctrl&gt;+C

  (gdb) n
  // Шаг вперед без захода в функцию.

  (gdb) s
  // Шаг вперед с заходом в функцию.
--------------------------------------------------------------------------------
</pre>
</p>У gdb есть возможность работы в режиме TUI (псевдо-графический интерфейс). Для этого можно добавить при запуске gdb параметр --tui. Также можно переключиться в TUI в уже запущенной сессии. Для этого используй &lt;Ctrl&gt;+X, затем клавишу A</p>
<p>Данная страница будет обновляться и дополняться.</p>
